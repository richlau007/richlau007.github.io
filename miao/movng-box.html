<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Document</title>
  <style>
    div{
      position: absolute;
      width: 30px;
      height: 30px;
    }
    #d1{
      background-color: brown;
    }
  </style>
</head>
<body>
  <div id="d1"></div>
  <div id="d2"></div>
  <script>
    d1.style.top = 100 + "px"
    d1.style.left = 100 + "px"
    var speedH = 0
    var speedV = 0
    
    var amni
    // amnimation()
    document.body.addEventListener('keydown',e =>{
      // console.log(e)
      if(speedH == 0 && speedV == 0){
        if (e.key == 'ArrowRight' || e.key == 'ArrowLeft' || e.key == 'ArrowUp' || e.key == 'ArrowDown') {
          amnimation()
        }
      }
      if(e.key == 'ArrowRight'){
        e.preventDefault()
        // if(speed < 10){
        //   speed+= 3
        // }
        // console.log('right',speedH)
        if(speedH <= 0){
          speedH = 1
        }else if(speedH < 5){
          speedH++
        }
        // d1.style.left = parseFloat(d1.style.left) + speedH +'px'
      }
      if(e.key == 'ArrowLeft'){
        e.preventDefault()
        // speedH = -30
        if (speedH >= 0) {
          speedH = -1
        } else if (speedH > -5) {
          speedH--
        }
        
      }
      if(e.key == 'ArrowUp'){
        e.preventDefault()
        // speedV = -30
        // d1.style.top = parseFloat(d1.style.top) + speedV +'px'
         if (speedV >= 0) {
          speedV = -1
        } else if (speedV > -5) {
          speedV--
        }
      }
      if(e.key == 'ArrowDown'){
        e.preventDefault()
        // speedV = 30
        // d1.style.top = parseFloat(d1.style.top) + speedV +'px'
          if (speedV <= 0) {
          speedV = 1
        } else if (speedV < 5) {
          speedV++
        }
      }
      if(e.key == ' '){
        speedV = 0 
        speedH = 0
        cancelAnimationFrame(amni)
        // console.log("s")
      }

    })

    function amnimation(){
      // console.log(111) 
      var l = parseFloat(d1.style.left) + speedH
      if(l >= 0 && l <= innerWidth - 30){
        d1.style.left = l + 'px'
      }

      var t = parseFloat(d1.style.top) + speedV
      if(t >= 0 && t <= innerHeight - 30){
        d1.style.top = t + 'px'
      }
      // console.log(d1.style.left)
      amni = requestAnimationFrame(amnimation)
    }

  </script>
</body>
</html>